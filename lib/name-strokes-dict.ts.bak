// 常用汉字笔画字典（部分常用字）

export const strokeCountDict: Record<string, number> = {
  // 数字
  '一': 1, '二': 2, '三': 3, '四': 4, '五': 5, '六': 6, '七': 7, '八': 8, '九': 9, '十': 10,
  '零': 13, '百': 6, '千': 3, '万': 3,
  
  // 常用姓氏
  '王': 4, '李': 7, '张': 7, '刘': 6, '陈': 7, '杨': 7, '黄': 12, '赵': 9, '吴': 7, '周': 8,
  '徐': 10, '孙': 6, '马': 3, '朱': 6, '胡': 9, '郭': 10, '何': 7, '高': 10, '林': 8, '罗': 8,
  '郑': 8, '梁': 11, '谢': 12, '宋': 7, '唐': 10, '许': 6, '韩': 12, '冯': 5, '邓': 4, '曹': 11,
  
  // 常用名字字（去重）
  '伟': 6, '芳': 7, '娜': 9, '秀': 7, '英': 8, '华': 6, '敏': 11, '静': 14, '丽': 7, '强': 11,
  '磊': 15, '军': 6, '洋': 9, '勇': 9, '艳': 10, '杰': 8, '娟': 10, '涛': 10, '明': 8, '超': 12,
  '霞': 17, '平': 5, '刚': 10, '桂': 10, '文': 4, '辉': 12, '鹏': 13, '丹': 4, '红': 6,
  '玲': 9, '玉': 5, '雪': 11, '梅': 11, '兰': 5, '菊': 11, '竹': 6, '松': 8, '柏': 9, '柳': 9,
  '春': 9, '夏': 10, '秋': 9, '冬': 5, '东': 5, '南': 9, '西': 6, '北': 5, '中': 4, '国': 8,
  '家': 10, '人': 2, '民': 5, '和': 8, '美': 9, '好': 6, '善': 12, '德': 15, '义': 3, '礼': 5,
  '智': 12, '信': 9, '忠': 8, '孝': 7, '仁': 4, '爱': 13, '友': 4, '诚': 8, '勤': 13, '俭': 9,
  '学': 8, '习': 3, '思': 9, '想': 13, '念': 8, '志': 7, '向': 6, '前': 9, '进': 7, '步': 7,
  '成': 6, '功': 5, '胜': 9, '利': 7, '富': 12, '贵': 12, '福': 13, '禄': 12, '寿': 7, '喜': 12,
  '乐': 5, '欢': 6, '笑': 10, '悦': 10, '欣': 8, '愉': 12, '快': 7, '兴': 6, '旺': 8, '盛': 11,
  '昌': 8, '隆': 11, '发': 5, '达': 6, '通': 10, '顺': 9, '吉': 6, '祥': 10, '瑞': 13,
  '康': 11, '健': 10, '安': 6, '宁': 5, '稳': 14, '定': 8, '清': 11, '洁': 9,
  '纯': 7, '真': 10, '正': 5, '直': 8, '坚': 7, '韧': 7, '毅': 15, '力': 2,
  '能': 10, '才': 3, '艺': 4, '技': 7, '术': 5, '知': 8, '识': 7, '见': 4, '闻': 9,
  '博': 12, '广': 3, '深': 11, '远': 7, '长': 4, '久': 3, '永': 5, '恒': 9,
  '新': 13, '鲜': 14, '亮': 9, '光': 6, '朗': 10, '晴': 12, '阳': 6, '暖': 13, '温': 12,
  '柔': 9, '软': 8, '细': 8, '微': 13, '精': 14, '密': 11, '严': 7, '谨': 13, '慎': 13, '小': 3,
  '巧': 5, '妙': 7, '奇': 8, '特': 10, '异': 6, '独': 9, '单': 8, '双': 4, '对': 5, '配': 10,
  '合': 6, '联': 12, '结': 12, '团': 6, '体': 7, '群': 13, '众': 6, '多': 6, '少': 4, '全': 6,
  '完': 7, '整': 16, '齐': 6, '统': 9, '同': 6, '共': 6, '公': 4,
  '协': 6, '调': 10, '谐': 11, '睦': 13, '亲': 9, '近': 7,
  '切': 4, '紧': 10, '急': 9, '速': 10, '迅': 6, '疾': 10, '猛': 11, '烈': 10,
  '巨': 4, '宏': 7, '壮': 6, '雄': 12, '豪': 14, '出': 5,
  '色': 6, '优': 6, '良': 7, '佳': 8, '艳': 10, '娇': 9,
  '媚': 12, '妩': 7, '越': 12, '过': 6,
  
  // 更多常用字可以继续添加...
};

// 计算汉字笔画数（增强版）
export function calculateCharStrokes(char: string): number {
  // 优先从字典查找
  if (strokeCountDict[char]) {
    return strokeCountDict[char];
  }
  
  // 如果字典中没有，使用估算方法
  // 基于Unicode范围估算（简化版）
  const code = char.charCodeAt(0);
  
  // 常用汉字范围（CJK统一汉字）
  if (code >= 0x4E00 && code <= 0x9FFF) {
    // 使用简单的估算：根据字符编码的某些特征
    return 8 + (code % 15); // 返回8-22之间的估算值
  }
  
  // 其他字符
  return 10; // 默认值
}

// 计算姓名总笔画数（增强版）
export function calculateNameStrokes(name: string): number {
  let total = 0;
  for (const char of name) {
    total += calculateCharStrokes(char);
  }
  return total;
}

// 获取汉字的五行属性
export function getCharWuxing(char: string): string {
  const strokes = calculateCharStrokes(char);
  const wuxingMap: Record<string, string[]> = {
    '金': ['4', '9', '14', '19', '24', '29'],
    '木': ['3', '8', '13', '18', '23', '28'],
    '水': ['1', '6', '11', '16', '21', '26'],
    '火': ['2', '7', '12', '17', '22', '27'],
    '土': ['5', '10', '15', '20', '25', '30'],
  };
  
  const lastDigit = (strokes % 10).toString();
  
  for (const [wuxing, digits] of Object.entries(wuxingMap)) {
    if (digits.includes(lastDigit)) {
      return wuxing;
    }
  }
  
  // 默认返回
  return '土';
}

// 分析姓名五行
export function analyzeNameWuxing(name: string): {
  chars: Array<{ char: string; strokes: number; wuxing: string }>;
  totalStrokes: number;
  wuxing: string[];
  balance: Record<string, number>;
} {
  const chars = [];
  let totalStrokes = 0;
  const wuxingCount: Record<string, number> = {
    '金': 0, '木': 0, '水': 0, '火': 0, '土': 0,
  };

  for (const char of name) {
    const strokes = calculateCharStrokes(char);
    const wuxing = getCharWuxing(char);
    chars.push({ char, strokes, wuxing });
    totalStrokes += strokes;
    wuxingCount[wuxing]++;
  }

  const wuxing = Object.entries(wuxingCount)
    .filter(([_, count]) => count > 0)
    .map(([wuxing]) => wuxing);

  return {
    chars,
    totalStrokes,
    wuxing,
    balance: wuxingCount,
  };
}
